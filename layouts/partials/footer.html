<footer class="mt-5 py-4 text-center">
  <div class="container">
    <a class="mb-0" href="https://github.com/enochyu-official" target="_blank" rel="noopener noreferrer">
      &copy; {{ now.Year }} {{ .Site.Params.author }}. All Rights Reserved.
    </a>
  </div>

  <script data-goatcounter="https://enochyu.goatcounter.com/count"
    async src="//gc.zgo.at/count.js"></script>

  <script>
    (function () {
      fetch("https://enochyu.goatcounter.com/counter/TOTAL.json?cb=" + Date.now())
        .then(r => {
          if (!r.ok) throw new Error("HTTP " + r.status);
          return r.json();
        })

        .then(d => {
          const el = document.getElementById("gc-total-views");
          if (el) el.textContent = d.count;
        })

        .catch(err => {
          const el = document.getElementById("gc-total-views");

          if (el) el.textContent = "ERR";
          console.error("GoatCounter:", err); 
        });
    })();
  </script>

  <script>
    function updateViewCounts() {
      const counters = document.querySelectorAll(".page-views");

      counters.forEach(el => {
        let path = el.getAttribute("data-gc-path");

        if (!path) {
          el.textContent = "0";
          return;
        }

        path = path.replace(/\/$/, "");
        const url = `https://enochyu.goatcounter.com/counter${path}.json`;

        fetch(url)
          .then(r => r.json())
          .then(d => {
            el.textContent = d.count || "0";
          })

          .catch(err => {
            console.error("GoatCounter Error:", err);
            el.textContent = "0";
          });
      });
    }

    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', updateViewCounts);
    } else {
      updateViewCounts();
    }
  </script>
</footer>
